import{aK as z,a7 as G,W as H,aB as q,b as A,a9 as P,aa as D,d as k,aA as W,i as $,aL as O,an as j,u as U,c as V,am as J,aM as S,a8 as Y,aN as Q,_ as M,a as C,e as K,o as x,r as E,n as w,g as d,aI as X,aw as Z,ab as ee,aO as le,s as v,k as l,p as R,t as ae,l as n,G as oe,ay as se,a3 as te,aF as ne,ah as ie,R as de,S as re,aP as ue,w as pe,aq as ce,a1 as me,M as B,J as fe,D as _e,C as N,v as be,x as ge,z as Ve,H as ve,y as we,B as he,q as Ce,I as ye}from"./index-YZcTT0ct.js";import{E as ke}from"./el-card-RPD74Z2k.js";import{E as Ee}from"./el-input-number-DPxQ_r4_.js";var xe=1,Ie=4;function Ne(p){return z(p,xe|Ie)}const F=p=>G(p)||H(p)||q(p),$e=A({accordion:Boolean,modelValue:{type:k([Array,String,Number]),default:()=>W([])},expandIconPosition:{type:k([String]),default:"right"},beforeCollapse:{type:k(Function)}}),Ue={[D]:F,[P]:F},T=Symbol("collapseContextKey"),Ke="ElCollapse",Oe=(p,i)=>{const a=$(O(p.modelValue)),m=r=>{a.value=r;const c=p.accordion?a.value[0]:a.value;i(D,c),i(P,c)},s=r=>{if(p.accordion)m([a.value[0]===r?"":r]);else{const c=[...a.value],t=c.indexOf(r);t>-1?c.splice(t,1):c.push(r),m(c)}},e=async r=>{const{beforeCollapse:c}=p;if(!c){s(r);return}const t=c(r);[S(t),Y(t)].includes(!0)||Q(Ke,"beforeCollapse must return type `Promise<boolean>` or `boolean`"),S(t)?t.then(g=>{g!==!1&&s(r)}).catch(g=>{}):t&&s(r)};return j(()=>p.modelValue,()=>a.value=O(p.modelValue),{deep:!0}),J(T,{activeNames:a,handleItemClick:e}),{activeNames:a,setActiveNames:m}},Se=p=>{const i=U("collapse");return{rootKls:V(()=>[i.b(),i.b(`icon-position-${p.expandIconPosition}`)])}},Be=C({name:"ElCollapse"}),Fe=C({...Be,props:$e,emits:Ue,setup(p,{expose:i,emit:a}){const m=p,{activeNames:s,setActiveNames:e}=Oe(m,a),{rootKls:r}=Se(m);return i({activeNames:s,setActiveNames:e}),(c,t)=>(x(),K("div",{class:w(d(r))},[E(c.$slots,"default")],2))}});var Ae=M(Fe,[["__file","collapse.vue"]]);const Pe=A({title:{type:String,default:""},name:{type:k([String,Number]),default:void 0},icon:{type:Z,default:X},disabled:Boolean}),De=p=>{const i=ee(T),{namespace:a}=U("collapse"),m=$(!1),s=$(!1),e=le(),r=V(()=>e.current++),c=V(()=>{var _;return(_=p.name)!=null?_:`${a.value}-id-${e.prefix}-${d(r)}`}),t=V(()=>i?.activeNames.value.includes(d(c)));return{focusing:m,id:r,isActive:t,handleFocus:()=>{setTimeout(()=>{s.value?s.value=!1:m.value=!0},50)},handleHeaderClick:_=>{if(p.disabled)return;const b=_.target;b?.closest("input, textarea, select")||(i?.handleItemClick(d(c)),m.value=!1,s.value=!0)},handleEnterClick:_=>{const b=_.target;b?.closest("input, textarea, select")||(_.preventDefault(),i?.handleItemClick(d(c)))}}},Me=(p,{focusing:i,isActive:a,id:m})=>{const s=U("collapse"),e=V(()=>[s.b("item"),s.is("active",d(a)),s.is("disabled",p.disabled)]),r=V(()=>[s.be("item","header"),s.is("active",d(a)),{focusing:d(i)&&!p.disabled}]),c=V(()=>[s.be("item","arrow"),s.is("active",d(a))]),t=V(()=>[s.be("item","title")]),u=V(()=>s.be("item","wrap")),g=V(()=>s.be("item","content")),f=V(()=>s.b(`content-${d(m)}`)),_=V(()=>s.b(`head-${d(m)}`));return{itemTitleKls:t,arrowKls:c,headKls:r,rootKls:e,itemWrapperKls:u,itemContentKls:g,scopedContentId:f,scopedHeadId:_}},Re=C({name:"ElCollapseItem"}),Te=C({...Re,props:Pe,setup(p,{expose:i}){const a=p,{focusing:m,id:s,isActive:e,handleFocus:r,handleHeaderClick:c,handleEnterClick:t}=De(a),{arrowKls:u,headKls:g,rootKls:f,itemTitleKls:_,itemWrapperKls:b,itemContentKls:I,scopedContentId:h,scopedHeadId:y}=Me(a,{focusing:m,isActive:e,id:s});return i({isActive:e}),(o,We)=>(x(),K("div",{class:w(d(f))},[v("div",{id:d(y),class:w(d(g)),"aria-expanded":d(e),"aria-controls":d(h),"aria-describedby":d(h),tabindex:o.disabled?-1:0,role:"button",onClick:d(c),onKeydown:ne(ie(d(t),["stop"]),["space","enter"]),onFocus:d(r),onBlur:je=>m.value=!1},[v("span",{class:w(d(_))},[E(o.$slots,"title",{isActive:d(e)},()=>[R(ae(o.title),1)])],2),E(o.$slots,"icon",{isActive:d(e)},()=>[l(d(te),{class:w(d(u))},{default:n(()=>[(x(),oe(se(o.icon)))]),_:1},8,["class"])])],42,["id","aria-expanded","aria-controls","aria-describedby","tabindex","onClick","onKeydown","onFocus","onBlur"]),l(d(ue),null,{default:n(()=>[de(v("div",{id:d(h),role:"region",class:w(d(b)),"aria-hidden":!d(e),"aria-labelledby":d(y)},[v("div",{class:w(d(I))},[E(o.$slots,"default")],2)],10,["id","aria-hidden","aria-labelledby"]),[[re,d(e)]])]),_:3})],2))}});var L=M(Te,[["__file","collapse-item.vue"]]);const Le=pe(Ae,{CollapseItem:L}),ze=ce(L),Ge=p=>me.post("/config",p).then(i=>i.data),He={class:"page"},qe=C({__name:"SetView",setup(p){const i=B({record_message:!0,scheduler:!0,echo:!0,inspect:!0,auto_reload:!0,commands:!0,help:!0}),a=B({basic:{network:[{type:"ws",host:"127.0.0.1",port:7777,token:"35c65152638a93de"}],ignore_self_message:!0,log:{level:"INFO",ignores:[],save:{enable:!1,rotation:"00:00",compression:"zip",colorize:!1}},prefix:["/"],skip_req_missing:!1,cmd_count:4096,external_dirs:[]},plugins:{$files:"",$prelude:"",record_message:{record_send:!0},auto_reload:{watch_dirs:"",watch_config:!0},echo:{},commands:{need_notice_me:!0,need_reply_me:!1,use_config_prefix:!0},help:{help_command:"help",help_alias:"帮助,命令帮助",page_size:10},database:{type:"sqlite",name:"database.db",driver:"aiosqlite"},server:{host:"127.0.0.1",port:5140,adapters:[{$path:"nekobox.main:NekoBoxAdapter",uin:2507078797,sign_url:"https://sign.lagrangecore.org/api/sign/30366",protocol:"remote",log_level:"INFO",use_png:!1}]},webui:{}}});fe(async()=>{try{const s=await _e.get(window.RUNTIME_CONFIG?.baseURL+"/config");Object.assign(a,Ne(s))}catch(s){N.error("加载配置失败，请检查后端服务是否正常"),console.error("加载配置失败",s)}});const m=async()=>{const s=JSON.parse(JSON.stringify(a));s.plugins.server.adapters.forEach(u=>{u.sign_url&&(u.sign_url=u.sign_url.trim())});const e={basic:{network:s.basic.network,ignore_self_message:s.basic.ignore_self_message,prefix:s.basic.prefix,log:{level:s.basic.log.level}},plugins:{}};s.basic.log.ignores?.length&&(e.basic.log.ignores=s.basic.log.ignores),s.basic.log.save?.enable&&(e.basic.log.save=s.basic.log.save);const r=["database","server","webui"],c=["record_message","scheduler","echo","inspect","auto_reload","commands","help","database","server","webui"],t={record_message:".",scheduler:".",echo:"::",inspect:"::",auto_reload:"::",commands:".",help:"::"};for(const u of c){const g=t[u]??"",_=i[u]??!0?`${g}${u}`:`~${u}`;e.plugins[_]=s.plugins[u]??{}}for(const u of r)u in s.plugins&&(e.plugins[u]=s.plugins[u]);s.plugins.$files&&(e.plugins.$files=s.plugins.$files),s.plugins.$prelude&&(e.plugins.$prelude=s.plugins.$prelude);try{await Ge(e),N.success("已保存")}catch(u){console.error("保存失败",u),N.error("保存失败")}};return(s,e)=>{const r=ve,c=Ve,t=ge,u=we,g=Ee,f=he,_=be,b=ze,I=Le,h=Ce,y=ke;return x(),K("div",He,[l(y,{shadow:"never",class:"card"},{header:n(()=>e[24]||(e[24]=[v("h1",null,"系统设置",-1),v("p",null,"一站式管理 Entari WebUI 与后端参数",-1)])),default:n(()=>[v("section",null,[e[25]||(e[25]=v("h2",null,"基础配置:",-1)),l(_,{"label-width":"120px",style:{"max-width":"480px"}},{default:n(()=>[l(t,{label:"类型"},{default:n(()=>[l(c,{modelValue:a.basic.network[0].type,"onUpdate:modelValue":e[0]||(e[0]=o=>a.basic.network[0].type=o),placeholder:"选择网络类型"},{default:n(()=>[l(r,{label:"ws",value:"ws"}),l(r,{label:"websocket",value:"websocket"}),l(r,{label:"wh",value:"wh"}),l(r,{label:"webhook",value:"webhook"})]),_:1},8,["modelValue"])]),_:1}),l(t,{label:"服务器地址"},{default:n(()=>[l(u,{modelValue:a.basic.network[0].host,"onUpdate:modelValue":e[1]||(e[1]=o=>a.basic.network[0].host=o),placeholder:"satori 服务器地址"},null,8,["modelValue"])]),_:1}),l(t,{label:"端口"},{default:n(()=>[l(g,{modelValue:a.basic.network[0].port,"onUpdate:modelValue":e[2]||(e[2]=o=>a.basic.network[0].port=o),min:1,max:65535},null,8,["modelValue"])]),_:1}),l(t,{label:"路径"},{default:n(()=>[l(u,{modelValue:a.basic.network[0].path,"onUpdate:modelValue":e[3]||(e[3]=o=>a.basic.network[0].path=o),placeholder:"satori 服务器路径(默认为空)"},null,8,["modelValue"])]),_:1}),l(t,{label:"token"},{default:n(()=>[l(u,{modelValue:a.basic.network[0].token,"onUpdate:modelValue":e[4]||(e[4]=o=>a.basic.network[0].token=o),placeholder:"账号配置文件的token"},null,8,["modelValue"])]),_:1}),l(t,{label:"忽略自身消息"},{default:n(()=>[l(f,{modelValue:a.basic.ignore_self_message,"onUpdate:modelValue":e[5]||(e[5]=o=>a.basic.ignore_self_message=o)},null,8,["modelValue"])]),_:1}),l(t,{label:"日志等级"},{default:n(()=>[l(c,{modelValue:a.basic.log.level,"onUpdate:modelValue":e[6]||(e[6]=o=>a.basic.log.level=o),placeholder:"选择日志等级",style:{width:"240px"}},{default:n(()=>[l(r,{label:"DEBUG",value:"DEBUG"}),l(r,{label:"INFO",value:"INFO"}),l(r,{label:"WARN",value:"WARN"}),l(r,{label:"ERROR",value:"ERROR"})]),_:1},8,["modelValue"])]),_:1}),l(t,{label:"指令前缀"},{default:n(()=>[l(c,{modelValue:a.basic.prefix,"onUpdate:modelValue":e[7]||(e[7]=o=>a.basic.prefix=o),multiple:"","allow-create":"",filterable:"",placeholder:"可留空，默认为 /",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),v("section",null,[e[27]||(e[27]=v("h2",null,"插件配置:",-1)),l(_,{model:a.plugins,"label-width":"160px",style:{"max-width":"600px"}},{default:n(()=>[l(t,{label:"插件搜索目录"},{default:n(()=>[l(u,{modelValue:a.plugins.$files,"onUpdate:modelValue":e[8]||(e[8]=o=>a.plugins.$files=o),placeholder:"多个目录用逗号分隔"},null,8,["modelValue"])]),_:1}),l(t,{label:"预加载插件"},{default:n(()=>[l(u,{modelValue:a.plugins.$prelude,"onUpdate:modelValue":e[9]||(e[9]=o=>a.plugins.$prelude=o),placeholder:"多个插件用逗号分隔"},null,8,["modelValue"])]),_:1}),l(I,null,{default:n(()=>[l(b,{title:"消息记录插件 (.record_message)"},{default:n(()=>[l(t,{label:"启用"},{default:n(()=>[l(f,{modelValue:i.record_message,"onUpdate:modelValue":e[10]||(e[10]=o=>i.record_message=o)},null,8,["modelValue"])]),_:1}),l(t,{label:"记录发送消息"},{default:n(()=>[l(f,{modelValue:a.plugins.record_message.record_send,"onUpdate:modelValue":e[11]||(e[11]=o=>a.plugins.record_message.record_send=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{title:"调度器插件 (.scheduler)"},{default:n(()=>[l(t,{label:"启用"},{default:n(()=>[l(f,{modelValue:i.scheduler,"onUpdate:modelValue":e[12]||(e[12]=o=>i.scheduler=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{title:"回声插件 (::echo)"},{default:n(()=>[l(t,{label:"启用"},{default:n(()=>[l(f,{modelValue:i.echo,"onUpdate:modelValue":e[13]||(e[13]=o=>i.echo=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{title:"调试插件 (::inspect)"},{default:n(()=>[l(t,{label:"启用"},{default:n(()=>[l(f,{modelValue:i.inspect,"onUpdate:modelValue":e[14]||(e[14]=o=>i.inspect=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{title:"自动重载插件 (::auto_reload)"},{default:n(()=>[l(t,{label:"启用"},{default:n(()=>[l(f,{modelValue:i.auto_reload,"onUpdate:modelValue":e[15]||(e[15]=o=>i.auto_reload=o)},null,8,["modelValue"])]),_:1}),l(t,{label:"监听目录"},{default:n(()=>[l(u,{modelValue:a.plugins.auto_reload.watch_dirs,"onUpdate:modelValue":e[16]||(e[16]=o=>a.plugins.auto_reload.watch_dirs=o),placeholder:"多个目录用逗号分隔"},null,8,["modelValue"])]),_:1}),l(t,{label:"监听配置文件"},{default:n(()=>[l(f,{modelValue:a.plugins.auto_reload.watch_config,"onUpdate:modelValue":e[17]||(e[17]=o=>a.plugins.auto_reload.watch_config=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{title:"指令插件配置 (.commands)"},{default:n(()=>[l(t,{label:"需要@机器人"},{default:n(()=>[l(f,{modelValue:a.plugins.commands.need_notice_me,"onUpdate:modelValue":e[18]||(e[18]=o=>a.plugins.commands.need_notice_me=o)},null,8,["modelValue"])]),_:1}),l(t,{label:"需要回复机器人"},{default:n(()=>[l(f,{modelValue:a.plugins.commands.need_reply_me,"onUpdate:modelValue":e[19]||(e[19]=o=>a.plugins.commands.need_reply_me=o)},null,8,["modelValue"])]),_:1}),l(t,{label:"使用配置前缀"},{default:n(()=>[l(f,{modelValue:a.plugins.commands.use_config_prefix,"onUpdate:modelValue":e[20]||(e[20]=o=>a.plugins.commands.use_config_prefix=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{title:"帮助插件 (::help)"},{default:n(()=>[l(t,{label:"帮助指令"},{default:n(()=>[l(u,{modelValue:a.plugins.help.help_command,"onUpdate:modelValue":e[21]||(e[21]=o=>a.plugins.help.help_command=o),placeholder:"默认为 help"},null,8,["modelValue"])]),_:1}),l(t,{label:"指令别名"},{default:n(()=>[l(u,{modelValue:a.plugins.help.help_alias,"onUpdate:modelValue":e[22]||(e[22]=o=>a.plugins.help.help_alias=o),placeholder:'多个别名用逗号分隔，如: "帮助","命令帮助"'},null,8,["modelValue"])]),_:1}),l(t,{label:"每页数量"},{default:n(()=>[l(g,{modelValue:a.plugins.help.page_size,"onUpdate:modelValue":e[23]||(e[23]=o=>a.plugins.help.page_size=o),min:1},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),l(h,{class:"save",onClick:m,type:"primary"},{default:n(()=>e[26]||(e[26]=[R("保存配置")])),_:1,__:[26]})])]),_:1})])}}}),Xe=ye(qe,[["__scopeId","data-v-a4b5accb"]]);export{Xe as default};
