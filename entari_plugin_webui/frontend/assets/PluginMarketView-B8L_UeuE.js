import{a as j,i,c as C,J as q,e as m,o,s,k as l,y as A,l as n,z as D,aP as G,F as h,A as E,H,G as k,f as J,t as u,m as R,p as _,a3 as $,bu as K,q as Q,aS as W,C as g,I as X}from"./index-CiK7xBkD.js";import{a as Y,E as Z,i as ee,u as ae}from"./plugin-DqFXgwtz.js";import{E as te}from"./el-card-9u0QYif0.js";const le={class:"plugin-market"},se={class:"header"},ne={class:"title"},oe={class:"desc"},re={class:"meta"},ie={class:"tags"},ue={class:"actions"},ce=j({__name:"PluginMarketView",setup(de){const w=i([]),p=i(""),c=i(""),S=["全部","推荐","媒体","统计","游戏","工具","实用"],x=C(()=>w.value.filter(a=>a.name.toLowerCase().includes(p.value.toLowerCase())&&(c.value==="全部"||c.value===""||a.tags.includes(c.value)))),v=i(6),f=i(1),b=C(()=>{const a=(f.value-1)*v.value;return x.value.slice(a,a+v.value)}),r=i(new Set),z=async a=>{r.value.add(a.name);try{await ee(a.name),a.installed=!0,g.success("安装成功")}catch(t){const d=t instanceof Error?t.message:String(t);g.error(d||"安装失败")}finally{r.value.delete(a.name)}},B=async a=>{r.value.add(a.name);try{await ae(a.name),a.installed=!1,g.success("卸载成功")}catch(t){const d=t instanceof Error?t.message:String(t);g.error(d||"卸载失败")}finally{r.value.delete(a.name)}};return q(async()=>{const a=await Y();w.value=a}),(a,t)=>{const d=A,I=H,M=D,P=R,N=K("StarFilled"),F=$,V=Q,U=te,L=W,T=G,O=Z;return o(),m("div",le,[s("div",se,[l(d,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),placeholder:"Search","prefix-icon":"Search",style:{width:"260px"}},null,8,["modelValue"]),l(M,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),placeholder:"标签",style:{width:"120px","margin-left":"12px"}},{default:n(()=>[(o(),m(h,null,E(S,e=>l(I,{key:e,label:e,value:e},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),l(T,{gutter:20,class:"list"},{default:n(()=>[(o(!0),m(h,null,E(b.value,e=>(o(),k(L,{key:e.name,xs:24,sm:12,md:8,style:{"margin-bottom":"20px"}},{default:n(()=>[l(U,{shadow:"hover",class:"plugin-card"},{default:n(()=>[s("div",ne,[s("span",null,u(e.fullName),1),e.installed?(o(),k(P,{key:0,size:"small",type:"success"},{default:n(()=>t[3]||(t[3]=[_("已安装")])),_:1,__:[3]})):J("",!0)]),s("p",oe,u(e.desc),1),s("div",re,[s("span",null,"@"+u(e.author),1),s("span",null,[l(F,null,{default:n(()=>[l(N)]),_:1}),_(u(e.stars),1)])]),s("div",ie,[(o(!0),m(h,null,E(e.tags,y=>(o(),k(P,{key:y},{default:n(()=>[_(u(y),1)]),_:2},1024))),128))]),s("div",ue,[l(V,{size:"small",text:""},{default:n(()=>t[4]||(t[4]=[_("查看文档")])),_:1,__:[4]}),l(V,{size:"small",type:e.installed?"danger":"primary",disabled:r.value.has(e.name),loading:r.value.has(e.name),onClick:y=>e.installed?B(e):z(e)},{default:n(()=>[_(u(e.installed?"卸载":"安装"),1)]),_:2},1032,["type","disabled","loading","onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),l(O,{"current-page":f.value,"onUpdate:currentPage":t[2]||(t[2]=e=>f.value=e),"page-size":v.value,total:x.value.length,layout:"prev, pager, next",style:{"justify-content":"center","margin-top":"20px"}},null,8,["current-page","page-size","total"])])}}}),pe=X(ce,[["__scopeId","data-v-2e9e9d0a"]]);export{pe as default};
